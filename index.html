<!doctype html>
<html>
<head>
<title>2048 Bookmarklet</title>
<link rel="icon" type="image/png" href="icon.png" />
<style>
@import url(http://fonts.googleapis.com/css?family=Karla);

.round {
  border-radius: 50px;
  border: 8px solid orange;
  color: orange;
  font-family: "Karla";
  font-size: 48pt;
  font-weight: bold;
  padding: 20px;
  text-decoration: none;
}

.disabled {
  -webkit-filter: grayscale(100%);
  -moz-filter: grayscale(100%);
}

body {
	text-align: center;
}

.desc {
  font-family: serif;
  font-size: 24pt;
  font-style: italic;
}
</style>
</head>
<body>
	<p class="desc">drag to bookmark bar</p>
	<a class="round disabled" id="bookmarklet">2048 solver</a>
<script>
var xhr = new XMLHttpRequest();
xhr.onload = jsLoad;
xhr.open("GET", "ai.js", true);
xhr.send();

function jsLoad() {
  var xhr = new XMLHttpRequest();
  xhr.onload = jsCompiled;
  xhr.open("POST", "http://closure-compiler.appspot.com/compile", true);
  xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
  xhr.send("compilation_level=ADVANCED_OPTIMIZATIONS"
    + "&output_format=text"
    + "&output_info=compiled_code"
    + "&js_code="+ encodeURIComponent(this.responseText));
}

function jsCompiled() {
  var bookmarklet = document.getElementById('bookmarklet');
  bookmarklet.setAttribute('href', 'javascript:(function(){'
    + this.responseText
    + '})();');
  bookmarklet.classList.remove('disabled');
}
</script>
</body>
</html>
